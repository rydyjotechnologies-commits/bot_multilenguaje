<script>
    async function enviar() {
        const mensaje = document.getElementById("mensaje").value;

        const res = await fetch("/chat", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ mensaje })
        });

        const data = await res.json();
        const texto = data.respuesta;

        document.getElementById("respuesta").innerText = texto;

        // ðŸ”Š HABLAR EL TEXTO
        hablar(texto);
    }

    function hablar(texto) {
        const voz = new SpeechSynthesisUtterance(texto);
        voz.lang = detectarIdioma(texto);
        voz.rate = 1;
        voz.pitch = 1;
        speechSynthesis.speak(voz);
    }

    function detectarIdioma(texto) {
        if (/^[a-zA-Z]/.test(texto)) return "en-US";
        if (texto.includes("Â¿") || texto.includes("Ã±")) return "es-ES";
        if (texto.includes("Ã§") || texto.includes("Ã©")) return "fr-FR";
        if (texto.includes("Ã£o")) return "pt-BR";
        return "es-ES";
    }
</script>
